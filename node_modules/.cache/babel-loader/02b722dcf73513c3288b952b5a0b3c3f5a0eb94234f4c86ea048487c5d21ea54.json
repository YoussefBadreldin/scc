{"ast":null,"code":"import HeaderComponent from '../../public/global/headerComponent.vue';\nimport FooterComponent from '../../public/global/footerComponent.vue';\nimport _ from 'lodash'; // Import lodash for debouncing\n\nexport default {\n  name: 'FindCommittee',\n  components: {\n    HeaderComponent,\n    FooterComponent\n  },\n  data() {\n    return {\n      universityNumber: '',\n      findplace: null,\n      errorMessage: '',\n      committees: [],\n      loading: false,\n      cache: {},\n      // Cache for committee data\n      studentsMap: {} // A hash map for fast student lookup\n    };\n  },\n  mounted() {\n    this.loadStudentData(); // Load student data on component mount\n  },\n  methods: {\n    // Debounced findCommittee method to reduce unnecessary API calls\n    findCommittee: _.debounce(async function () {\n      this.loading = true; // Start loading\n      this.errorMessage = '';\n      this.findplace = null; // Hide previous data\n\n      const studentData = this.studentsMap[this.universityNumber];\n      if (!studentData) {\n        this.errorMessage = 'الرقم الذي أدخلته غير صحيح، يرجى التحقق منه';\n        this.loading = false; // Stop loading\n        return;\n      }\n      const committees = await this.fetchCommitteesByLevel(studentData.student_level);\n      this.findplace = studentData;\n      this.committees = committees;\n      this.loading = false; // Stop loading\n    }, 300),\n    // Debounce with 300ms delay\n\n    async loadStudentData() {\n      try {\n        const response = await fetch('https://aiusu-backend.vercel.app/students');\n        if (!response.ok) throw new Error('Failed to fetch student data');\n        const students = await response.json();\n\n        // Create a hash map for faster lookups\n        this.studentsMap = students.reduce((map, student) => {\n          map[student.student_id] = student;\n          return map;\n        }, {});\n      } catch (error) {\n        console.error('Error loading student data:', error);\n      }\n    },\n    async fetchCommitteesByLevel(level) {\n      if (this.cache[level]) return this.cache[level]; // Return cached data if available\n\n      const committeeURLs = ['https://aiusu-backend.vercel.app/clubs', 'https://aiusu-backend.vercel.app/sports', 'https://aiusu-backend.vercel.app/cultural', 'https://aiusu-backend.vercel.app/arts', 'https://aiusu-backend.vercel.app/scout', 'https://aiusu-backend.vercel.app/social', 'https://aiusu-backend.vercel.app/scientific'];\n      const committeeNames = {\n        'https://aiusu-backend.vercel.app/clubs': 'لجنة الاسر',\n        'https://aiusu-backend.vercel.app/sports': 'اللجنة الرياضية',\n        'https://aiusu-backend.vercel.app/cultural': 'اللجنة الثقافية والاعلامية',\n        'https://aiusu-backend.vercel.app/arts': 'اللجنة الفنية',\n        'https://aiusu-backend.vercel.app/scout': 'لجنة الجوالة والخدمة العامة',\n        'https://aiusu-backend.vercel.app/social': 'اللجنة الاجتماعية والرحلات',\n        'https://aiusu-backend.vercel.app/scientific': 'اللجنة العلمية والتكنولوجية'\n      };\n      const committeePromises = committeeURLs.map(async url => {\n        const response = await fetch(url);\n        if (!response.ok) return null;\n        const candidates = await response.json();\n        const filteredCandidates = candidates.filter(candidate => candidate.candidate_level === level).map(candidate => ({\n          ...candidate,\n          photo: `../../images/candidates/${candidate.candidate_id}.jpg`\n        }));\n        return {\n          name: committeeNames[url],\n          candidates: filteredCandidates\n        };\n      });\n      const committees = await Promise.all(committeePromises);\n      this.cache[level] = committees.filter(committee => committee && committee.candidates.length > 0); // Cache results\n      return this.cache[level];\n    }\n  }\n};","map":{"version":3,"names":["HeaderComponent","FooterComponent","_","name","components","data","universityNumber","findplace","errorMessage","committees","loading","cache","studentsMap","mounted","loadStudentData","methods","findCommittee","debounce","studentData","fetchCommitteesByLevel","student_level","response","fetch","ok","Error","students","json","reduce","map","student","student_id","error","console","level","committeeURLs","committeeNames","committeePromises","url","candidates","filteredCandidates","filter","candidate","candidate_level","photo","candidate_id","Promise","all","committee","length"],"sources":["C:\\Users\\Youssef Badreldin\\Documents\\GitHub\\AIUSU\\src\\views\\elections.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <HeaderComponent />\r\n        <div class=\"container\">\r\n            <h2 class=\"text-center my-4\">ابحث عن لجنتك الانتخابية</h2>\r\n            <form @submit.prevent=\"findCommittee\">\r\n                <div class=\"mb-3\">\r\n                    <label for=\"universityNumber\" class=\"form-label\"><strong>:رقمك الجامعي</strong></label>\r\n                    <input type=\"text\" v-model=\"universityNumber\" class=\"form-control\" id=\"universityNumber\" required />\r\n                </div>\r\n                <button type=\"submit\" class=\"btn btn-primary\">إبحث</button>\r\n            </form>\r\n\r\n            <div v-if=\"loading\" class=\"alert alert-info mt-4\"> ...جاري التحميل</div> <!-- Loading message -->\r\n            <div v-if=\"errorMessage\" class=\"alert alert-danger mt-4\">{{ errorMessage }}</div> <!-- Error message -->\r\n\r\n            <div v-if=\"findplace && !loading\" class=\"mt-4\">\r\n                <h4><strong>معلومات لجنتك</strong></h4>\r\n                <p><strong>الاسم:</strong> {{ findplace.student_name }}</p>\r\n                <p><strong>الكلية:</strong> {{ findplace.student_faculty }}</p>\r\n                <p><strong>الرقم الجامعي:</strong> {{ findplace.student_id }}</p>\r\n                <p><strong>المستوى:</strong> {{ findplace.student_level }}</p>\r\n                <p>{{ findplace.student_location }} <strong> :مكان اللجنة</strong></p>\r\n                <p><strong>رقم الكشف:</strong> {{ findplace.student_number }}</p>\r\n\r\n                <br>\r\n                <h4><strong>المرشحون الذين لك الحق في انتخابهم</strong></h4>\r\n\r\n                <div v-for=\"(committee, index) in committees\" :key=\"index\" class=\"committee-container mb-4\">\r\n                    <h6>{{ committee.name }}</h6>\r\n                    <ul>\r\n                        <li v-for=\"candidate in committee.candidates\" :key=\"candidate.id\" class=\"candidate-item\">\r\n                            <div class=\"candidate-photo\">\r\n                                <img :src=\"`../../images/candidates/${candidate.candidate_id}.jpg`\" alt=\"مرشح\" loading=\"lazy\" />\r\n                            </div>\r\n                            <div class=\"candidate-details\">\r\n                                <span class=\"candidate-name\">{{ candidate.candidate_name }}</span>\r\n                                <span class=\"candidate-faculty\">{{ candidate.candidate_faculty }}</span>\r\n                            </div>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n\r\n                <!-- Election Guidelines Section -->\r\n                <div class=\"election-guidelines mt-4\">\r\n                    <h4><strong>إرشادات هامة</strong></h4>\r\n                    <div class=\"video-container mt-4\">\r\n                        <iframe width=\"350\" height=\"180\" src=\"https://www.youtube.com/embed/87vnQi8zsiQ?si=IwxCPZCQvBf_pAab\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\r\n                    </div>\r\n                    <br>\r\n                    <h5>: نظام الانتخابات</h5>\r\n                    <ul>\r\n                        <li>(أي 2 في كل لجنة) ستقوم بانتخاب 14 عضوًا لسبع لجان</li>\r\n                    </ul>\r\n                    <h5>: خطوات التصويت</h5>\r\n                    <ol>\r\n                        <li>قم بالتوقيع في كشف الحضور قبل أن تبدأ بالتصويت</li>\r\n                        <li>ستتلقى ورقة انتخابية مخصصة لك</li>\r\n                        <li>اكتب أسماء 14 مرشحًا، بحيث يكون لكل اثنين في لجنة</li>\r\n                        <li>تأكد من كتابة 14 اسمًا، لأن أي ورقة تحتوي على أقل أو أكثر من 14 اسمًا أو أي علامات ستعتبر باطلة</li>\r\n                    </ol>\r\n                    <h5>: ملاحظات هامة</h5>\r\n                    <ul>\r\n                        <li>يمكنك انتخاب المرشحين المذكورين في القائمة أعلاه فقط، ولا يمكنك انتخاب طلاب آخرين</li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <FooterComponent />\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport HeaderComponent from '../../public/global/headerComponent.vue';\r\nimport FooterComponent from '../../public/global/footerComponent.vue';\r\nimport _ from 'lodash'; // Import lodash for debouncing\r\n\r\nexport default {\r\n    name: 'FindCommittee',\r\n    components: {\r\n        HeaderComponent,\r\n        FooterComponent,\r\n    },\r\n    data() {\r\n        return {\r\n            universityNumber: '',\r\n            findplace: null,\r\n            errorMessage: '',\r\n            committees: [],\r\n            loading: false,\r\n            cache: {}, // Cache for committee data\r\n            studentsMap: {}, // A hash map for fast student lookup\r\n        };\r\n    },\r\n    mounted() {\r\n        this.loadStudentData(); // Load student data on component mount\r\n    },\r\n    methods: {\r\n        // Debounced findCommittee method to reduce unnecessary API calls\r\n        findCommittee: _.debounce(async function() {\r\n            this.loading = true;  // Start loading\r\n            this.errorMessage = '';\r\n            this.findplace = null; // Hide previous data\r\n\r\n            const studentData = this.studentsMap[this.universityNumber];\r\n\r\n            if (!studentData) {\r\n                this.errorMessage = 'الرقم الذي أدخلته غير صحيح، يرجى التحقق منه';\r\n                this.loading = false;  // Stop loading\r\n                return;\r\n            }\r\n\r\n            const committees = await this.fetchCommitteesByLevel(studentData.student_level);\r\n\r\n            this.findplace = studentData;\r\n            this.committees = committees;\r\n            this.loading = false;  // Stop loading\r\n        }, 300), // Debounce with 300ms delay\r\n\r\n        async loadStudentData() {\r\n            try {\r\n                const response = await fetch('https://aiusu-backend.vercel.app/students');\r\n                if (!response.ok) throw new Error('Failed to fetch student data');\r\n                const students = await response.json();\r\n                \r\n                // Create a hash map for faster lookups\r\n                this.studentsMap = students.reduce((map, student) => {\r\n                    map[student.student_id] = student;\r\n                    return map;\r\n                }, {});\r\n            } catch (error) {\r\n                console.error('Error loading student data:', error);\r\n            }\r\n        },\r\n\r\n        async fetchCommitteesByLevel(level) {\r\n            if (this.cache[level]) return this.cache[level]; // Return cached data if available\r\n\r\n            const committeeURLs = [\r\n                'https://aiusu-backend.vercel.app/clubs',\r\n                'https://aiusu-backend.vercel.app/sports',\r\n                'https://aiusu-backend.vercel.app/cultural',\r\n                'https://aiusu-backend.vercel.app/arts',\r\n                'https://aiusu-backend.vercel.app/scout',                \r\n                'https://aiusu-backend.vercel.app/social',\r\n                'https://aiusu-backend.vercel.app/scientific',\r\n            ];\r\n\r\n            const committeeNames = {\r\n                'https://aiusu-backend.vercel.app/clubs': 'لجنة الاسر',\r\n                'https://aiusu-backend.vercel.app/sports': 'اللجنة الرياضية',\r\n                'https://aiusu-backend.vercel.app/cultural': 'اللجنة الثقافية والاعلامية',\r\n                'https://aiusu-backend.vercel.app/arts': 'اللجنة الفنية',\r\n                'https://aiusu-backend.vercel.app/scout': 'لجنة الجوالة والخدمة العامة',\r\n                'https://aiusu-backend.vercel.app/social': 'اللجنة الاجتماعية والرحلات',\r\n                'https://aiusu-backend.vercel.app/scientific': 'اللجنة العلمية والتكنولوجية',\r\n            };\r\n\r\n            const committeePromises = committeeURLs.map(async (url) => {\r\n                const response = await fetch(url);\r\n                if (!response.ok) return null;\r\n\r\n                const candidates = await response.json();\r\n                const filteredCandidates = candidates\r\n                    .filter(candidate => candidate.candidate_level === level)\r\n                    .map(candidate => ({\r\n                        ...candidate,\r\n                        photo: `../../images/candidates/${candidate.candidate_id}.jpg`,\r\n                    }));\r\n\r\n                return {\r\n                    name: committeeNames[url],\r\n                    candidates: filteredCandidates,\r\n                };\r\n            });\r\n\r\n            const committees = await Promise.all(committeePromises);\r\n            this.cache[level] = committees.filter(committee => committee && committee.candidates.length > 0); // Cache results\r\n            return this.cache[level];\r\n        },\r\n    },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n    padding: 20px;\r\n}\r\n.committee-container {\r\n    border: 1px solid #ddd;\r\n    padding: 15px;\r\n    border-radius: 8px;\r\n}\r\n.committee-container h6 {\r\n    margin-bottom: 10px;\r\n    font-size: 1.5em;\r\n    font-weight: bold;\r\n}\r\n.committee-container ul {\r\n    list-style: none;\r\n    padding-left: 0;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content: space-between;\r\n}\r\n.candidate-item {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    margin: 15px;\r\n    flex: 0 1 calc(33.333% - 30px);\r\n    box-sizing: border-box;\r\n}\r\n.candidate-photo img {\r\n    width: 70px;\r\n    height: auto;\r\n    border-radius: 50%;\r\n}\r\n.candidate-name {\r\n    font-weight: bold;\r\n    margin-top: 5px;\r\n    font-size: 1em;\r\n}\r\n.candidate-faculty {\r\n    color: #555;\r\n    margin-top: 2px;\r\n    display: block;\r\n    font-size: 0.9em;\r\n}\r\n.alert {\r\n    margin-top: 20px;\r\n}\r\n.video-container {\r\n    margin-top: 20px;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}